package driver

var kcom3KeyMap = map[Key]byte{
	K_ESC: 0x29,

	K_F1:  0x3a,
	K_F2:  0x3b,
	K_F3:  0x3c,
	K_F4:  0x3d,
	K_F5:  0x3e,
	K_F6:  0x3f,
	K_F7:  0x40,
	K_F8:  0x41,
	K_F9:  0x42,
	K_F10: 0x43,
	K_F11: 0x44,
	K_F12: 0x45,

	K_0: 0x27,
	K_1: 0x1e,
	K_2: 0x1f,
	K_3: 0x20,
	K_4: 0x21,
	K_5: 0x22,
	K_6: 0x23,
	K_7: 0x24,
	K_8: 0x25,
	K_9: 0x26,

	K_A: 0x04,
	K_B: 0x05,
	K_C: 0x06,
	K_D: 0x07,
	K_E: 0x08,
	K_F: 0x09,
	K_G: 0x0a,
	K_H: 0x0b,
	K_I: 0x0c,
	K_J: 0x0d,
	K_K: 0x0e,
	K_L: 0x0f,
	K_M: 0x10,
	K_N: 0x11,
	K_O: 0x12,
	K_P: 0x13,
	K_Q: 0x14,
	K_R: 0x15,
	K_S: 0x16,
	K_T: 0x17,
	K_U: 0x18,
	K_V: 0x19,
	K_W: 0x1a,
	K_X: 0x1b,
	K_Y: 0x1c,
	K_Z: 0x1d,

	K_GRAVE:      0x35,
	K_MINUS:      0x2d,
	K_EQUAL:      0x2e,
	K_BACKSPACE:  0x2a,
	K_TAB:        0x2b,
	K_LEFTBRACE:  0x2f,
	K_RIGHTBRACE: 0x30,
	K_BACKSLASH:  0x31,
	K_SEMICOLON:  0x33,
	K_APOSTROPHE: 0x34,
	K_ENTER:      0x28,
	K_SHIFT:      0xe1,
	K_COMMA:      0x36,
	K_DOT:        0x37,
	K_SLASH:      0x38,
	K_CTRL:       0xe0,
	K_ALT:        0xe2,
	K_SPACE:      0x2c,
	K_INSERT:     0x49,
	K_DELETE:     0x4c,
	K_HOME:       0x4a,
	K_END:        0x4d,
	K_PAGEUP:     0x4b,
	K_PAGEDOWN:   0x4e,
	K_UP:         0x52,
	K_DOWN:       0x51,
	K_LEFT:       0x50,
	K_RIGHT:      0x4f,
}

func EncodeForKCOM3(ks Keycodes) []byte {
	var res [11]byte = [11]byte{0x57, 0xab, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
	if ks == EmptyKeycodes {
		return res[:]
	}

	pos := 5
	for _, k := range ks {
		if k == K_CTRL {
			res[3] |= 0x01
		} else if k == K_SHIFT {
			res[3] |= 0x02
		} else if k == K_ALT {
			res[3] |= 0x04
		} else {
			res[pos] = kcom3KeyMap[k]
			pos++
		}
	}
	return res[:]
}
